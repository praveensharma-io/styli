{"ast":null,"code":"import React,{useMemo}from'react';import{useParams}from'react-router-dom';import{Spinner,Alert,Button}from'react-bootstrap';import useServerDrivenUI from'../hooks/useServerDrivenUI';import HeroComponent from'./ui/HeroComponent';import ProductGridComponent from'./ui/ProductGridComponent';import BannerComponent from'./ui/BannerComponent';import CategoryListComponent from'./ui/CategoryListComponent';import FeaturedProductsComponent from'./ui/FeaturedProductsComponent';import CartComponent from'./ui/CartComponent';import CheckoutComponent from'./ui/CheckoutComponent';import HeaderComponent from'./ui/HeaderComponent';import FooterComponent from'./ui/FooterComponent';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const DynamicLayout=_ref=>{let{pageType:propPageType,pageId:propPageId}=_ref;const params=useParams();const pageType=propPageType||params.pageType;const pageId=propPageId||params.pageId;console.log('ðŸŽ¯ DynamicLayout props:',{propPageType,propPageId});console.log('ðŸŽ¯ DynamicLayout params:',params);console.log('ðŸŽ¯ DynamicLayout final:',{pageType,pageId});// User context - in a real app, this would come from auth context\n// Use useMemo to prevent recreation on every render\nconst userContext=useMemo(()=>({userId:'60d21b4667d0d8992e610c85',userRole:'customer',deviceType:'desktop',locale:'en-US',timezone:'Asia/Dubai'}),[]);// Empty dependency array means this object is created only once\nconst{layout,loading,error,refreshLayout,updateComponentData}=useServerDrivenUI(pageType,pageId,userContext);const renderComponent=component=>{const{type,config,data}=component;switch(type){case'hero':return/*#__PURE__*/_jsx(HeroComponent,{config:config,data:data});case'productGrid':return/*#__PURE__*/_jsx(ProductGridComponent,{config:config,data:data});case'banner':return/*#__PURE__*/_jsx(BannerComponent,{config:config,data:data});case'categoryList':return/*#__PURE__*/_jsx(CategoryListComponent,{config:config,data:data});case'featuredProducts':return/*#__PURE__*/_jsx(FeaturedProductsComponent,{config:config,data:data});case'cart':return/*#__PURE__*/_jsx(CartComponent,{config:config,data:data});case'checkout':return/*#__PURE__*/_jsx(CheckoutComponent,{config:config,data:data});case'header':return/*#__PURE__*/_jsx(HeaderComponent,{config:config,data:data});case'footer':return/*#__PURE__*/_jsx(FooterComponent,{config:config,data:data});default:return/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-warning\",children:[\"Unknown component type: \",type]});}};if(loading){return/*#__PURE__*/_jsxs(\"div\",{className:\"container py-5 text-center\",children:[/*#__PURE__*/_jsx(Spinner,{animation:\"border\",variant:\"primary\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-3\",children:\"Loading dynamic layout...\"}),/*#__PURE__*/_jsx(Button,{variant:\"outline-primary\",onClick:()=>{console.log('ðŸ§ª Manual API test...');fetch('http://localhost:3000/api/health').then(res=>res.json()).then(data=>console.log('ðŸ§ª Manual test result:',data)).catch(err=>console.error('ðŸ§ª Manual test error:',err));},className:\"mt-3\",children:\"Test API Connection\"})]});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"container py-5\",children:/*#__PURE__*/_jsxs(Alert,{variant:\"danger\",children:[/*#__PURE__*/_jsx(Alert.Heading,{children:\"Error Loading Layout\"}),/*#__PURE__*/_jsx(\"p\",{children:error}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(Button,{variant:\"outline-danger\",onClick:refreshLayout,children:\"Try Again\"})]})});}if(!layout){return/*#__PURE__*/_jsx(\"div\",{className:\"container py-5\",children:/*#__PURE__*/_jsxs(Alert,{variant:\"warning\",children:[/*#__PURE__*/_jsx(Alert.Heading,{children:\"No Layout Found\"}),/*#__PURE__*/_jsx(\"p\",{children:\"No layout configuration found for this page.\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"dynamic-layout\",children:[layout.metadata&&/*#__PURE__*/_jsxs(\"div\",{style:{display:'none'},children:[/*#__PURE__*/_jsx(\"title\",{children:layout.metadata.title}),/*#__PURE__*/_jsx(\"meta\",{name:\"description\",content:layout.metadata.description}),layout.metadata.keywords&&/*#__PURE__*/_jsx(\"meta\",{name:\"keywords\",content:layout.metadata.keywords.join(', ')}),layout.metadata.ogImage&&/*#__PURE__*/_jsx(\"meta\",{property:\"og:image\",content:layout.metadata.ogImage})]}),layout.components.map((component,index)=>/*#__PURE__*/_jsx(\"div\",{className:\"component-wrapper\",children:renderComponent(component)},`${component.id}-${index}`))]});};export default DynamicLayout;","map":{"version":3,"names":["React","useMemo","useParams","Spinner","Alert","Button","useServerDrivenUI","HeroComponent","ProductGridComponent","BannerComponent","CategoryListComponent","FeaturedProductsComponent","CartComponent","CheckoutComponent","HeaderComponent","FooterComponent","jsx","_jsx","jsxs","_jsxs","DynamicLayout","_ref","pageType","propPageType","pageId","propPageId","params","console","log","userContext","userId","userRole","deviceType","locale","timezone","layout","loading","error","refreshLayout","updateComponentData","renderComponent","component","type","config","data","className","children","animation","variant","onClick","fetch","then","res","json","catch","err","Heading","metadata","style","display","title","name","content","description","keywords","join","ogImage","property","components","map","index","id"],"sources":["/Users/macos/stylii/client/src/components/DynamicLayout.js"],"sourcesContent":["import React, { useMemo } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { Spinner, Alert, Button } from 'react-bootstrap';\nimport useServerDrivenUI from '../hooks/useServerDrivenUI';\nimport HeroComponent from './ui/HeroComponent';\nimport ProductGridComponent from './ui/ProductGridComponent';\nimport BannerComponent from './ui/BannerComponent';\nimport CategoryListComponent from './ui/CategoryListComponent';\nimport FeaturedProductsComponent from './ui/FeaturedProductsComponent';\nimport CartComponent from './ui/CartComponent';\nimport CheckoutComponent from './ui/CheckoutComponent';\nimport HeaderComponent from './ui/HeaderComponent';\nimport FooterComponent from './ui/FooterComponent';\n\nconst DynamicLayout = ({ pageType: propPageType, pageId: propPageId }) => {\n  const params = useParams();\n  const pageType = propPageType || params.pageType;\n  const pageId = propPageId || params.pageId;\n  \n  console.log('ðŸŽ¯ DynamicLayout props:', { propPageType, propPageId });\n  console.log('ðŸŽ¯ DynamicLayout params:', params);\n  console.log('ðŸŽ¯ DynamicLayout final:', { pageType, pageId });\n  \n  // User context - in a real app, this would come from auth context\n  // Use useMemo to prevent recreation on every render\n  const userContext = useMemo(() => ({\n    userId: '60d21b4667d0d8992e610c85',\n    userRole: 'customer',\n    deviceType: 'desktop',\n    locale: 'en-US',\n    timezone: 'Asia/Dubai'\n  }), []); // Empty dependency array means this object is created only once\n\n  const {\n    layout,\n    loading,\n    error,\n    refreshLayout,\n    updateComponentData\n  } = useServerDrivenUI(pageType, pageId, userContext);\n\n  const renderComponent = (component) => {\n    const { type, config, data } = component;\n\n    switch (type) {\n      case 'hero':\n        return <HeroComponent config={config} data={data} />;\n      case 'productGrid':\n        return <ProductGridComponent config={config} data={data} />;\n      case 'banner':\n        return <BannerComponent config={config} data={data} />;\n      case 'categoryList':\n        return <CategoryListComponent config={config} data={data} />;\n      case 'featuredProducts':\n        return <FeaturedProductsComponent config={config} data={data} />;\n      case 'cart':\n        return <CartComponent config={config} data={data} />;\n      case 'checkout':\n        return <CheckoutComponent config={config} data={data} />;\n      case 'header':\n        return <HeaderComponent config={config} data={data} />;\n      case 'footer':\n        return <FooterComponent config={config} data={data} />;\n      default:\n        return (\n          <div className=\"alert alert-warning\">\n            Unknown component type: {type}\n          </div>\n        );\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"container py-5 text-center\">\n        <Spinner animation=\"border\" variant=\"primary\" />\n        <p className=\"mt-3\">Loading dynamic layout...</p>\n        <Button \n          variant=\"outline-primary\" \n          onClick={() => {\n            console.log('ðŸ§ª Manual API test...');\n            fetch('http://localhost:3000/api/health')\n              .then(res => res.json())\n              .then(data => console.log('ðŸ§ª Manual test result:', data))\n              .catch(err => console.error('ðŸ§ª Manual test error:', err));\n          }}\n          className=\"mt-3\"\n        >\n          Test API Connection\n        </Button>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"container py-5\">\n        <Alert variant=\"danger\">\n          <Alert.Heading>Error Loading Layout</Alert.Heading>\n          <p>{error}</p>\n          <hr />\n          <Button variant=\"outline-danger\" onClick={refreshLayout}>\n            Try Again\n          </Button>\n        </Alert>\n      </div>\n    );\n  }\n\n  if (!layout) {\n    return (\n      <div className=\"container py-5\">\n        <Alert variant=\"warning\">\n          <Alert.Heading>No Layout Found</Alert.Heading>\n          <p>No layout configuration found for this page.</p>\n        </Alert>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"dynamic-layout\">\n      {/* Page Metadata */}\n      {layout.metadata && (\n        <div style={{ display: 'none' }}>\n          <title>{layout.metadata.title}</title>\n          <meta name=\"description\" content={layout.metadata.description} />\n          {layout.metadata.keywords && (\n            <meta name=\"keywords\" content={layout.metadata.keywords.join(', ')} />\n          )}\n          {layout.metadata.ogImage && (\n            <meta property=\"og:image\" content={layout.metadata.ogImage} />\n          )}\n        </div>\n      )}\n\n      {/* Render Components */}\n      {layout.components.map((component, index) => (\n        <div key={`${component.id}-${index}`} className=\"component-wrapper\">\n          {renderComponent(component)}\n        </div>\n      ))}\n    </div>\n  );\n};\n\nexport default DynamicLayout; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}