{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useCallback } from 'react';\nconst useServerDrivenUI = (pageType, pageId, userContext = {}) => {\n  _s();\n  const [layout, setLayout] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [lastFetched, setLastFetched] = useState(null);\n  const fetchLayout = useCallback(async () => {\n    try {\n      console.log('ðŸ”„ Fetching layout:', {\n        pageType,\n        pageId,\n        userContext\n      });\n      setLoading(true);\n      setError(null);\n      const queryParams = new URLSearchParams({\n        ...userContext,\n        timestamp: Date.now() // Cache busting\n      });\n      const apiUrl = `http://localhost:3000/api/layouts/${pageType}/${pageId}?${queryParams}`;\n      console.log('ðŸ“¡ API URL:', apiUrl);\n\n      // Use the full backend URL since React app is on port 3001 and backend is on port 3000\n      const response = await fetch(apiUrl);\n      console.log('ðŸ“¥ Response status:', response.status);\n      const data = await response.json();\n      console.log('ðŸ“¦ Response data:', data);\n      if (data.success) {\n        setLayout(data.layout);\n        setLastFetched(Date.now());\n        console.log('âœ… Layout loaded successfully');\n      } else {\n        setError(data.message || 'Failed to load layout');\n        console.error('âŒ Layout load failed:', data.message);\n      }\n    } catch (error) {\n      console.error('ðŸ’¥ Error fetching layout:', error);\n      setError('Failed to load page layout');\n    } finally {\n      setLoading(false);\n    }\n  }, [pageType, pageId, userContext]);\n  const refreshLayout = useCallback(() => {\n    console.log('ðŸ”„ Refreshing layout...');\n    fetchLayout();\n  }, [fetchLayout]);\n  const updateComponentData = useCallback((componentId, newData) => {\n    if (!layout) return;\n    setLayout(prevLayout => ({\n      ...prevLayout,\n      components: prevLayout.components.map(component => component.id === componentId ? {\n        ...component,\n        data: {\n          ...component.data,\n          ...newData\n        }\n      } : component)\n    }));\n  }, [layout]);\n  const getComponentById = useCallback(componentId => {\n    if (!layout) return null;\n    return layout.components.find(component => component.id === componentId);\n  }, [layout]);\n  const getComponentsByType = useCallback(componentType => {\n    if (!layout) return [];\n    return layout.components.filter(component => component.type === componentType);\n  }, [layout]);\n  useEffect(() => {\n    console.log('ðŸŽ¯ useServerDrivenUI effect triggered:', {\n      pageType,\n      pageId\n    });\n    fetchLayout();\n  }, [fetchLayout]);\n  return {\n    layout,\n    loading,\n    error,\n    lastFetched,\n    refreshLayout,\n    updateComponentData,\n    getComponentById,\n    getComponentsByType\n  };\n};\n_s(useServerDrivenUI, \"VJyY/KxWkE9X/mXM6vB6h/IHzC4=\");\nexport default useServerDrivenUI;","map":{"version":3,"names":["useState","useEffect","useCallback","useServerDrivenUI","pageType","pageId","userContext","_s","layout","setLayout","loading","setLoading","error","setError","lastFetched","setLastFetched","fetchLayout","console","log","queryParams","URLSearchParams","timestamp","Date","now","apiUrl","response","fetch","status","data","json","success","message","refreshLayout","updateComponentData","componentId","newData","prevLayout","components","map","component","id","getComponentById","find","getComponentsByType","componentType","filter","type"],"sources":["/Users/macos/stylii/client/src/hooks/useServerDrivenUI.js"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\n\nconst useServerDrivenUI = (pageType, pageId, userContext = {}) => {\n  const [layout, setLayout] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [lastFetched, setLastFetched] = useState(null);\n\n  const fetchLayout = useCallback(async () => {\n    try {\n      console.log('ðŸ”„ Fetching layout:', { pageType, pageId, userContext });\n      setLoading(true);\n      setError(null);\n\n      const queryParams = new URLSearchParams({\n        ...userContext,\n        timestamp: Date.now() // Cache busting\n      });\n\n      const apiUrl = `http://localhost:3000/api/layouts/${pageType}/${pageId}?${queryParams}`;\n      console.log('ðŸ“¡ API URL:', apiUrl);\n\n      // Use the full backend URL since React app is on port 3001 and backend is on port 3000\n      const response = await fetch(apiUrl);\n      console.log('ðŸ“¥ Response status:', response.status);\n      \n      const data = await response.json();\n      console.log('ðŸ“¦ Response data:', data);\n\n      if (data.success) {\n        setLayout(data.layout);\n        setLastFetched(Date.now());\n        console.log('âœ… Layout loaded successfully');\n      } else {\n        setError(data.message || 'Failed to load layout');\n        console.error('âŒ Layout load failed:', data.message);\n      }\n    } catch (error) {\n      console.error('ðŸ’¥ Error fetching layout:', error);\n      setError('Failed to load page layout');\n    } finally {\n      setLoading(false);\n    }\n  }, [pageType, pageId, userContext]);\n\n  const refreshLayout = useCallback(() => {\n    console.log('ðŸ”„ Refreshing layout...');\n    fetchLayout();\n  }, [fetchLayout]);\n\n  const updateComponentData = useCallback((componentId, newData) => {\n    if (!layout) return;\n\n    setLayout(prevLayout => ({\n      ...prevLayout,\n      components: prevLayout.components.map(component =>\n        component.id === componentId\n          ? { ...component, data: { ...component.data, ...newData } }\n          : component\n      )\n    }));\n  }, [layout]);\n\n  const getComponentById = useCallback((componentId) => {\n    if (!layout) return null;\n    return layout.components.find(component => component.id === componentId);\n  }, [layout]);\n\n  const getComponentsByType = useCallback((componentType) => {\n    if (!layout) return [];\n    return layout.components.filter(component => component.type === componentType);\n  }, [layout]);\n\n  useEffect(() => {\n    console.log('ðŸŽ¯ useServerDrivenUI effect triggered:', { pageType, pageId });\n    fetchLayout();\n  }, [fetchLayout]);\n\n  return {\n    layout,\n    loading,\n    error,\n    lastFetched,\n    refreshLayout,\n    updateComponentData,\n    getComponentById,\n    getComponentsByType\n  };\n};\n\nexport default useServerDrivenUI; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}